<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medicine Cabinet - Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;500&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Kanit', sans-serif; background-color: #f0f2f5; padding-top: 30px; }
        .main-card { border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: none; background: white; }
        .status-dot { height: 12px; width: 12px; background-color: #2ecc71; border-radius: 50%; display: inline-block; margin-right: 5px; }
        .table thead { background-color: #007bff; color: white; }
        .last-update { font-size: 0.8rem; color: #6c757d; }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-card p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="m-0 text-primary">üíä ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡πà‡∏≤‡∏¢‡∏¢‡∏≤‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</h2>
                <div><span class="status-dot"></span> <span class="text-success">‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</span></div>
            </div>
            
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å</th>
                            <th>‡∏£‡∏´‡∏±‡∏™‡∏¢‡∏≤ (Barcode)</th>
                            <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (Slot)</th>
                        </tr>
                    </thead>
                    <tbody id="medicine-data">
                        <tr><td colspan="3" class="text-center">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î...</td></tr>
                    </tbody>
                </table>
            </div>
            <div class="text-end last-update" id="update-time"></div>
        </div>
    </div>

    <script>
        // *** ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ô‡∏≥ URL CSV ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Google Sheets (Publish to web) ‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ***
        const csvUrl = '‡πÉ‡∏™‡πà_URL_CSV_‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ';

        async function updateDashboard() {
            try {
                const response = await fetch(csvUrl);
                const data = await response.text();
                const rows = data.split('\n');
                let tableHtml = '';

                // ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏Ç‡πâ‡∏≤‡∏°‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á)
                for (let i = 1; i < rows.length; i++) {
                    const cols = rows[i].split(',');
                    if (cols.length >= 3) {
                        tableHtml += `<tr>
                            <td>${cols[0]}</td>
                            <td><strong>${cols[1]}</strong></td>
                            <td><span class="badge bg-info text-dark">${cols[2]}</span></td>
                        </tr>`;
                    }
                }
                document.getElementById('medicine-data').innerHTML = tableHtml;
                document.getElementById('update-time').innerText = "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏∑‡πà‡∏≠: " + new Date().toLocaleTimeString();
            } catch (error) {
                console.error("Error fetching data:", error);
            }
        }

        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å‡πÜ 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        setInterval(updateDashboard, 10000);
        updateDashboard();
    </script>
</body>
</html>
